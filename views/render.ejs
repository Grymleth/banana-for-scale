<!DOCTYPE html>
<html>
	<head>
        <!-- Head -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="render.css">
        <title>Banana For Scale | <%= title %></title>
    </head>
	<body>
		<p></p>
		<canvas id="myCanvas"></canvas>
		<script src="threejs/three.js"></script>
		<script src="threejs/OrbitControls.js"></script>
		<script src="threejs/GLTFLoader.js"></script>
		<script>
			var renderer = new THREE.WebGLRenderer({canvas: document.getElementById('myCanvas'), antialias: true });
			renderer.setClearColor(0xe5e5e5);
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);

			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

			var controls = new THREE.OrbitControls(camera, renderer.domElement);
			camera.position.set(0, 2, 10);
			controls.update();

			var light = new THREE.AmbientLight(0x404040, 0.5);
			scene.add(light);

			var dlight = new THREE.DirectionalLight(0xffffff, 1);
			dlight.position.set(0,1,0);
			dlight.castShadow = true;
			scene.add(dlight);

			var plight = new THREE.PointLight(0xc4c4c4, 1);
			plight.position.set(0,300,500);
			scene.add(plight);

			var banana;
			var loader = new THREE.GLTFLoader();
			loader.load('threejs/banana.gltf', function(gltf){
				banana = gltf.scene.children[0];
				console.log(banana);
				scene.add(gltf.scene);
				renderer.render(scene, camera);
			});

			var dimensions = {
				width: centiToMeter('<%= dimensions.width %>'),
				height: centiToMeter('<%= dimensions.height %>'),
				depth: centiToMeter('<%= dimensions.depth %>')
			}

			var geometry = new THREE.BoxGeometry(
				dimensions.width, 
				dimensions.height, 
				dimensions.depth
				);
			var material = new THREE.MeshNormalMaterial();
			var mesh = new THREE.Mesh(geometry, material);
			mesh.position.z = - ((dimensions.depth / 2) + (0.178/2));

			scene.add(mesh);

			render();

			function render(){
				renderer.render(scene, camera);
				controls.update();
				requestAnimationFrame(render);
			}

			function centiToMeter(centi){
				return centi / 100;
			}
		</script>
	</body>
</html>